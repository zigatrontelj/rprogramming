---
title: "NLB project"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(psych)
library(ggplot2)

initial.data <- read.table("~/Desktop/anketaFinal.csv", header=TRUE, sep=";", dec=",", na.strings=c("-2", "-3", "-4", "-5"))

select1 <- initial.data %>%
  select(Q20, Q1, Q2a, Q2b, Q2c, Q2d, Q2e, Q2f, Q2g, Q2h, Q2i, Q2j) %>% 
  mutate(Q20=replace(Q20, Q20 == -1, 1)) %>% 
  mutate(Q2a=replace(Q2a, Q2a == -1, 1)) %>% 
  mutate(Q2b=replace(Q2b, Q2b == -1, 1)) %>% 
  mutate(Q2c=replace(Q2c, Q2c == -1, 1)) %>% 
  mutate(Q2d=replace(Q2d, Q2d == -1, 1)) %>% 
  mutate(Q2e=replace(Q2e, Q2e == -1, 1)) %>% 
  mutate(Q2f=replace(Q2f, Q2f == -1, 1)) %>% 
  mutate(Q2g=replace(Q2g, Q2g == -1, 1)) %>% 
  mutate(Q2h=replace(Q2h, Q2h == -1, 1)) %>% 
  mutate(Q2i=replace(Q2i, Q2i == -1, 1)) %>% 
  mutate(Q2j=replace(Q2j, Q2j == -1, 1)) %>% 
  drop_na()

select1$Q20Factor <- factor(select1$Q20,
                            levels = c(1:14),
                            labels = c("Primary", "Primary", "Primary", "Primary", "Secondary", "Secondary", "Secondary", "Secondary", "Terciar", "Terciar", "Terciar", "Terciar",  "Terciar",  "Terciar"))

select1$Q2aFactor <- factor(select1$Q2a,
                            levels = c(1:5),
                            labels = c("Ne financiramo", "1 leto", "2-3 let", "4-5 let", "5+ let"))

select1$Q2bFactor <- factor(select1$Q2b,
                            levels = c(1:5),
                            labels = c("Ne financiramo", "1 leto", "2-3 let", "4-5 let", "5+ let"))

select1$Q2cFactor <- factor(select1$Q2c,
                            levels = c(1:5),
                            labels = c("Ne financiramo", "1 leto", "2-3 let", "4-5 let", "5+ let"))

select1$Q2dFactor <- factor(select1$Q2d,
                            levels = c(1:5),
                            labels = c("Ne financiramo", "1 leto", "2-3 let", "4-5 let", "5+ let"))

select1$Q2eFactor <- factor(select1$Q2e,
                            levels = c(1:5),
                            labels = c("Ne financiramo", "1 leto", "2-3 let", "4-5 let", "5+ let"))

select1$Q2fFactor <- factor(select1$Q2f,
                            levels = c(1:5),
                            labels = c("Ne financiramo", "1 leto", "2-3 let", "4-5 let", "5+ let"))

select1$Q2gFactor <- factor(select1$Q2g,
                            levels = c(1:5),
                            labels = c("Ne financiramo", "1 leto", "2-3 let", "4-5 let", "5+ let"))

select1$Q2hFactor <- factor(select1$Q2h,
                            levels = c(1:5),
                            labels = c("Ne financiramo", "1 leto", "2-3 let", "4-5 let", "5+ let"))

select1$Q2iFactor <- factor(select1$Q2i,
                            levels = c(1:5),
                            labels = c("Ne financiramo", "1 leto", "2-3 let", "4-5 let", "5+ let"))

print("Recikliranje:")
(recikliranje <- as.data.frame.matrix(table(select1$Q20Factor, select1$Q2aFactor)))
chisq.test(select1$Q20Factor, select1$Q2aFactor, correct = TRUE)

print("Uporaba okolju prijaznih materialov:")
(okolje <- as.data.frame.matrix(table(select1$Q20Factor, select1$Q2bFactor)))
chisq.test(select1$Q20Factor, select1$Q2bFactor, correct = TRUE)

print("Zmanjšanje porabe elektrike:")
(energija <- as.data.frame.matrix(table(select1$Q20Factor, select1$Q2cFactor)))
chisq.test(select1$Q20Factor, select1$Q2cFactor, correct = TRUE)

print("Zmanjšanje porabe pitne vode:")
(voda <- as.data.frame.matrix(table(select1$Q20Factor, select1$Q2dFactor)))
chisq.test(select1$Q20Factor, select1$Q2dFactor, correct = TRUE)

print("Zmanjšanje emisij CO2:")
(emisij <- as.data.frame.matrix(table(select1$Q20Factor, select1$Q2eFactor)))
chisq.test(select1$Q20Factor, select1$Q2eFactor, correct = TRUE)

print("Uporaba obnovljivih virov energije:")
(virov <- as.data.frame.matrix(table(select1$Q20Factor, select1$Q2fFactor)))
chisq.test(select1$Q20Factor, select1$Q2fFactor, correct = TRUE)

print("Brezpapirno poslovanje:")
(brezpap <- as.data.frame.matrix(table(select1$Q20Factor, select1$Q2gFactor)))
chisq.test(select1$Q20Factor, select1$Q2gFactor, correct = TRUE)

print("Delo od doma:")
(doma <- as.data.frame.matrix(table(select1$Q20Factor, select1$Q2hFactor)))
chisq.test(select1$Q20Factor, select1$Q2hFactor, correct = TRUE)

print("Car sharing:")
(carsh <- as.data.frame.matrix(table(select1$Q20Factor, select1$Q2iFactor)))
chisq.test(select1$Q20Factor, select1$Q2iFactor, correct = TRUE)
```


